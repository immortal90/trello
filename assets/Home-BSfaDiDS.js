import{r as l,j as e,L as C,B as s}from"./index-BSmJBPnd.js";import{c as b,i as m,a as j,B}from"./colorImages-dxv912c7.js";const w=({id:o,title:i,custom:d,onBoardUpdated:a})=>{const[u,f]=l.useState(!1),[t,h]=l.useState(i),[x,n]=l.useState((d==null?void 0:d.color)||""),c=r=>{h(r.target.value)},y=async(r,g)=>{console.log(r),g.preventDefault(),g.stopPropagation(),n(r);try{await m.put(`/board/${o}`,{title:t,custom:{color:r}}),s.success("Фон дошки успішно оновлено."),a&&a()}catch{s.error("Сталася помилка при оновленні фону дошки.")}},p=async()=>{if(!j.test(t)){s.error("Імʼя дошки може містити лише літери, цифри, пробіли, тире, крапки та нижні підкреслення.");return}try{await m.put(`/board/${o}`,{title:t,custom:{color:x}}),s.success("Дошку успішно оновлено."),f(!1),a&&a()}catch{s.error("Сталася помилка при оновленні дошки.")}},k=r=>{u&&r.preventDefault()};return e.jsx(C,{to:`/board/${o}`,style:{textDecoration:"none"},onClick:k,children:e.jsx("div",{className:"board-item",style:{"--board-background":`url(${x})`},children:u?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:t,onChange:c,onKeyDown:r=>r.key==="Enter"&&p(),onBlur:p,autoFocus:!0}),e.jsx("div",{className:"color-picker",children:b.map((r,g)=>e.jsx("img",{src:r.base64,alt:`Color ${g}`,onClick:v=>y(r.base64,v)},g))})]}):e.jsx("h3",{onClick:r=>{r.preventDefault(),f(!0)},children:t})})})},S=({onBoardCreated:o})=>{const[i,d]=l.useState(""),[a,u]=l.useState("#ffffff"),f=async()=>{if(i.trim()===""){s.error("Назва дошки не може бути порожньою.");return}if(!j.test(i)){s.error("Ім'я дошки може містити лише літери, цифри, пробіли, тире, крапки та нижні підкреслення.");return}try{const t=await m.post("board",{title:i,custom:{color:a}});console.log("Відповідь сервера:",t),d(""),u("#ffffff"),s.success("Дошку успішно створено."),o()}catch(t){t instanceof Error?s.error(`Не вдалося створити дошку. Помилка: ${t.message}`):s.error("Не вдалося створити дошку. Спробуйте ще раз.")}};return e.jsx("div",{className:"modal",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h3",{children:"Нова дошка"}),e.jsx("input",{type:"text",value:i,onChange:t=>d(t.target.value),placeholder:"Назва дошки"}),e.jsx("input",{type:"color",value:a,onChange:t=>u(t.target.value),title:"Виберіть колір для дошки"}),e.jsx("button",{onClick:f,children:"Додати"}),e.jsx("button",{onClick:()=>o(),children:"Закрити"})]})})},$=()=>{const[o,i]=l.useState([]),[d,a]=l.useState(!1),[u,f]=l.useState(!1),t=l.useRef(!0),h=async(n=!0)=>{f(!0);try{const c=await m.get("board");console.log(c.boards),i(c.boards),n&&t.current&&(s.success("Дошки успішно завантажені!"),t.current=!1)}catch(c){c instanceof Error?s.error(`Помилка завантаження дошок: ${c.message}`):s.error("Невідома помилка")}finally{f(!1)}};l.useEffect(()=>{h(!0)},[]);const x=()=>{h(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"home-container",children:u?e.jsx("p",{children:"Завантаження..."}):Array.isArray(o)&&o.length>0?o.map(n=>{var c;return e.jsx("div",{className:"board",style:{backgroundColor:((c=n.custom)==null?void 0:c.color)||"#ffffff"},children:e.jsx(w,{id:n.id,title:n.title,custom:n.custom,cards:n.cards,onBoardUpdated:x})},n.id)}):e.jsx("p",{children:"Немає доступних дошок."})}),e.jsx(B,{onClick:()=>a(!0),children:"Додати нову дошку"}),d&&e.jsx(S,{onBoardCreated:()=>{a(!1),h()}})]})};export{$ as default};
